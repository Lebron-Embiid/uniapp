(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/store_detail/store_detail"],{"1ba9":function(t,e,a){"use strict";a("1a7f");var i=n(a("b0ce")),s=n(a("bb9e"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},"3ee0":function(t,e,a){},"6afd":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("d250")),s=n(a("b505"));function n(t){return t&&t.__esModule?t:{default:t}}var o={data:function(){return{indicatorDots:!0,autoplay:!0,interval:3e3,duration:800,swiperList:[],navbar:[{name:"商品详情"},{name:"评价"}],currentTab:0,id:"",title:"",info:"深层清洁皮肤，长效保湿滋润",price:"",max_price:"",original_price:"",gauge:"",sales:"",unit:"",content:"",fixed_show:1,animationData:{},buy_img:"../../static/store_img1.jpg",buy_price:"999.00",buy_save:7,buy_num:1,is_format:1,buy_format:[],mch_list:[],attr:[],attr_id:[],score_1:0,score_2:0,score_3:0,score_all:0,page:1,page_count:1,comment_count:{},comment_list:[]}},components:{uParse:i.default,commonSwiper:s.default},methods:{toContact:function(){t.navigateTo({url:"/pages/feedback/feedback"})},toBigImg:function(){var e=this,a=[];a.push(e.buy_img),t.previewImage({urls:a,current:0})},navbarTap:function(e){var a=this;a.currentTab=e,1==a.currentTab&&t.request({url:a.$api+"default/comment-list&goods_id="+a.id+"&access_token="+a.$access_token,method:"GET",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log(t.data.data),a.comment_list=t.data.data.list,a.comment_count=t.data.data.comment_count},fail:function(e){t.showToast({title:e.data.msg,icon:"none"})}})},toIndex:function(e){t.switchTab({url:"/pages/index/index"})},previewImgs:function(e){var a=this;t.previewImage({urls:a.swiperList,current:a.swiperList[e]})},minus_num:function(t){var e=this;e.buy_num--,e.buy_num<=0&&(e.buy_num=1)},plus_num:function(t){var e=this;e.buy_num++,e.buy_num>=99&&(e.buy_num=99)},toAddCar:function(e){var a=this;if(0!=a.is_format)return a.fixed_show=0,t.showToast({title:"请选择规格",icon:"none"}),!1;t.request({url:a.$api+"cart/add-cart&access_token="+a.$access_token,method:"POST",data:{cat_list:JSON.stringify(a.attr_id),goods_id:a.id,attr:JSON.stringify(a.attr),num:a.buy_num},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){0==e.data.code?t.showToast({title:"添加成功",icon:"success"}):t.showToast({title:e.data.msg,icon:"none"})},fail:function(){t.showToast({title:"添加购物车失败",icon:"none"})}})},toBuy:function(e){var a=this;if(console.log(a.buy_num),0!=a.is_format)return a.fixed_show=0,t.showToast({title:"请选择规格",icon:"none"}),!1;var i=[];i.push({goods_id:a.id,num:a.buy_num,attr:a.attr}),a.mch_list.push({mch_id:0,goods_list:i}),console.log(a.mch_list),t.request({url:a.$api+"order/new-submit-preview&access_token="+a.$access_token,method:"POST",data:{mch_list:JSON.stringify(a.mch_list)},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){0==e.data.code?t.navigateTo({url:"/pages/account/account?data="+JSON.stringify(e.data.data)+"&cat_list="+JSON.stringify(a.attr_id)}):t.showToast({title:e.data.msg,icon:"none"})},fail:function(){t.showToast({title:"立即购买失败",icon:"none"})}})},selectFormat:function(e,a,i,s){var n=this;n.attr[i]={attr_group_id:n.buy_format[i].id,attr_group_name:n.buy_format[i].name,attr_id:n.buy_format[i].list[s].attr_id,attr_name:n.buy_format[i].list[s].attr_name},n.attr_id[i]=n.attr[i].attr_id,n.buy_format[i].current=[i,s];var o=n.buy_format.length;if(n.attr.length==o&&(n.is_format=0),n.attr_id.length!=n.buy_format.length||void 0==n.attr_id[0])return!1;t.request({url:n.$api+"default/goods-attr-info&access_token="+n.$access_token,method:"GET",data:{attr_list:JSON.stringify(n.attr_id),goods_id:n.id},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){var e=t.data.data;n.buy_save=e.num,n.price=e.goods_price,n.max_price=e.goods_price,""!=e.pic&&(n.buy_img=e.pic)},fail:function(e){t.showToast({title:e.data.msg,icon:"none"})}})},showFixed:function(t){this.fixed_show=0},hideFixed:function(t){this.fixed_show=1}},onLoad:function(e){t.showLoading({title:"加载中"});var a=this;a.$access_token=t.getStorageSync("access_token"),a.$level=t.getStorageSync("level"),setTimeout(function(){a.id=e.id,t.request({url:a.$api+"default/goods&id=1&access_token="+a.$access_token,method:"GET",data:{id:e.id},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){var i=[],s=[],n=e.data.data;for(var o in n.pic_list)i.push(n.pic_list[o].pic_url);for(var r in n.attr_group_list)s.push({id:n.attr_group_list[r].attr_group_id,name:n.attr_group_list[r].attr_group_name,list:n.attr_group_list[r].attr_list,current:[-1,-1]});a.swiperList=i,a.title=n.name,a.price=n.price,a.max_price=n.max_price,a.original_price=n.original_price,a.sales=n.sales,a.buy_save=n.num,a.buy_format=s,a.buy_img=a.swiperList[0],a.content=n.detail,a.gauge=n.gauge,a.unit=n.unit,t.hideLoading()},fail:function(e){t.showToast({title:JSON.stringify(e),icon:"none",duration:1500})}})},1e3),t.startPullDownRefresh()},onPullDownRefresh:function(){var e=this;e.$access_token=t.getStorageSync("access_token"),e.$level=t.getStorageSync("level"),setTimeout(function(){t.request({url:e.$api+"default/goods&id=1&access_token="+e.$access_token,method:"GET",data:{id:e.id},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){var a=[],i=[],s=t.data.data;for(var n in s.pic_list)a.push(s.pic_list[n].pic_url);for(var o in s.attr_group_list)i.push({id:s.attr_group_list[o].attr_group_id,name:s.attr_group_list[o].attr_group_name,list:s.attr_group_list[o].attr_list,current:[-1,-1]});e.swiperList=a,e.title=s.name,e.price=s.price,e.max_price=s.max_price,e.sales=s.sales,e.buy_save=s.num,e.buy_format=i,e.buy_img=e.swiperList[0],e.content=s.detail,e.gauge=s.gauge,e.unit=s.unit},fail:function(e){t.showToast({title:JSON.stringify(e),icon:"none",duration:1500})}}),t.stopPullDownRefresh()},1e3)},onReachBottom:function(){var e=this;return 0!=e.currentTab&&(e.page==e.page_count?(t.showToast({title:"没有更多数据了",icon:"none"}),!1):(e.page=parseInt(e.page)+parseInt(1),void t.request({url:e.$api+"default/comment-list&goods_id="+e.id+"&access_token="+e.$access_token,method:"GET",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){var a=t.data.data.list;e.comment_list=e.comment_list.concat(a),console.log(e.comment_list)},fail:function(e){t.showToast({title:e.data.msg,icon:"none"})}})))}};e.default=o}).call(this,a("6e42")["default"])},"7a1b":function(t,e,a){"use strict";var i=a("3ee0"),s=a.n(i);s.a},8110:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"store_detail"},[a("view",{staticClass:"detail_banner"},[a("swiper",{staticClass:"swiper",attrs:{"indicator-dots":t.indicatorDots,circular:"true",autoplay:t.autoplay,interval:t.interval,duration:t.duration}},t._l(t.swiperList,function(e,i){return a("swiper-item",{key:i,attrs:{eventid:"641f63ab-0-"+i,mpcomid:"641f63ab-0-"+i},on:{click:function(e){t.previewImgs(i)}}},[a("view",{staticClass:"swiper-item"},[a("image",{attrs:{src:e,mode:"widthFix"}})])])}))],1),a("view",{staticClass:"detail_info borbom"},[a("view",{staticClass:"di_title"},[t._v(t._s(t.title))]),a("view",{staticClass:"di_price"},[t._v("￥"+t._s(t.max_price)),a("text",{staticClass:"line"},[t._v("￥"+t._s(t.original_price))]),""!=t.gauge||0!=t.gauge?a("block",[a("text",[t._v("规格："+t._s(t.gauge)+t._s(t.unit))])]):t._e(),a("text",[t._v("已售："+t._s(t.sales))])],1)]),t._m(0),a("view",{staticClass:"format_box borbom"},[a("text",[t._v("规格")]),a("view",{staticClass:"format_select",attrs:{eventid:"641f63ab-1"},on:{click:t.showFixed}},[t._v("规格"),a("image",{attrs:{src:"../../static/next.png",mode:"widthFix"}})])]),a("view",{staticClass:"store_tab"},t._l(t.navbar,function(e,i){return a("view",{key:i,class:[t.currentTab==i?"active":""],attrs:{eventid:"641f63ab-2-"+i},on:{click:function(e){t.navbarTap(i)}}},[t._v(t._s(e.name))])})),a("view",{directives:[{name:"show",rawName:"v-show",value:0==t.currentTab,expression:"currentTab == 0"}],staticClass:"store_content1 mb98"},[""!=t.content?a("block",[a("u-parse",{attrs:{content:t.content,mpcomid:"641f63ab-1"}})],1):t._e()],1),a("view",{directives:[{name:"show",rawName:"v-show",value:1==t.currentTab,expression:"currentTab == 1"}],staticClass:"store_content2 mb98"},[a("view",{staticClass:"review_nav"},[a("navigator",{attrs:{url:""}},[t._v("全部"),a("text",[t._v("("+t._s(t.comment_count.score_all)+")")])]),a("navigator",{attrs:{url:""}},[t._v("好评"),a("text",[t._v("("+t._s(t.comment_count.score_3)+")")])]),a("navigator",{attrs:{url:""}},[t._v("中评"),a("text",[t._v("("+t._s(t.comment_count.score_2)+")")])]),a("navigator",{attrs:{url:""}},[t._v("差评"),a("text",[t._v("("+t._s(t.comment_count.score_1)+")")])])],1),a("view",{staticClass:"review_list"},t._l(t.comment_list,function(e,i){return a("view",{key:i,staticClass:"review_item"},[a("view",{staticClass:"review_top"},[a("view",{staticClass:"rt_info"},[a("image",{attrs:{src:e.avatar_url,mode:"widthFix"}}),a("text",{staticClass:"rt_name"},[t._v(t._s(e.nickname))])]),a("text",{staticClass:"rt_time"},[t._v(t._s(e.addtime))])]),a("view",{staticClass:"review_content"},[a("view",{staticClass:"rc_content"},[t._v(t._s(e.content))]),a("view",{staticClass:"rc_pic"},t._l(e.pic_list,function(t,e){return a("block",{key:e},[a("image",{attrs:{src:t,mode:"widthFix"}})])}))]),e.reply_content?a("block",[a("view",{staticClass:"reply_content"},[a("text",[t._v("商家：")]),t._v(t._s(e.reply_content))])]):t._e()],1)}))]),a("view",{staticClass:"fixed_bottom"},[a("view",{staticClass:"fb_left",attrs:{eventid:"641f63ab-3"},on:{click:t.toIndex}},[a("image",{attrs:{src:"../../static/back_home.png",mode:"widthFix"}}),t._v("首页")]),a("view",{staticClass:"fb_center",attrs:{eventid:"641f63ab-4"},on:{click:t.toAddCar}},[t._v("加入购物车")]),a("view",{staticClass:"fb_right",attrs:{eventid:"641f63ab-5"},on:{click:t.toBuy}},[t._v("立即购买")])]),a("view",{directives:[{name:"show",rawName:"v-show",value:!t.fixed_show,expression:"!fixed_show"}],staticClass:"fixed_shadow",attrs:{eventid:"641f63ab-6"},on:{click:t.hideFixed}}),a("view",{directives:[{name:"show",rawName:"v-show",value:!t.fixed_show,expression:"!fixed_show"}],staticClass:"fixed_layer",attrs:{animation:t.animationData}},[a("view",{staticClass:"fixed_top"},[a("view",{staticClass:"ft_img",attrs:{eventid:"641f63ab-7"},on:{tap:t.toBigImg}},[a("image",{attrs:{src:t.buy_img,mode:"widthFix"}})]),a("view",{staticClass:"ft_info"},[a("view",{staticClass:"fi_price"},[t._v("￥"+t._s(t.price))]),a("view",{staticClass:"fi_save"},[t._v("库存"+t._s(t.buy_save))]),a("view",{staticClass:"fi_close",attrs:{eventid:"641f63ab-8"},on:{click:t.hideFixed}},[a("image",{attrs:{src:"../../static/close.png",mode:"widthFix"}})])])]),a("view",{staticClass:"layer_format"},t._l(t.buy_format,function(e,i){return a("view",{key:i,staticClass:"format_item"},[a("view",{staticClass:"format_name"},[t._v(t._s(e.name))]),a("view",{staticClass:"format_list"},t._l(e.list,function(s,n){return a("view",{key:n,staticClass:"fl_item",class:[e.current[0]==i&&e.current[1]==n?"active":""],attrs:{eventid:"641f63ab-9-"+i+"-"+n},on:{click:function(a){t.selectFormat(e.id,s.attr_id,i,n)}}},[t._v(t._s(s.attr_name))])}))])})),a("view",{staticClass:"layer_num"},[a("text",[t._v("数量")]),a("view",{staticClass:"num_box"},[a("view",{staticClass:"num_minus",attrs:{eventid:"641f63ab-10"},on:{click:t.minus_num}},[t._v("-")]),a("view",{staticClass:"num_quantity"},[t._v(t._s(t.buy_num))]),a("view",{staticClass:"num_plus",attrs:{eventid:"641f63ab-11"},on:{click:t.plus_num}},[t._v("+")])])])]),a("view",{staticClass:"contact_customer",attrs:{eventid:"641f63ab-12"},on:{tap:function(e){e.stopPropagation(),t.toContact(e)}}},[a("image",{attrs:{src:"../../static/kefu.png",mode:"widthFix"}})])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"auth_box borbom"},[a("view",[a("image",{attrs:{src:"../../static/ok.jpg",mode:"widthFix"}}),t._v("正品保障")]),a("view",[a("image",{attrs:{src:"../../static/ok.jpg",mode:"widthFix"}}),t._v("极速发货")])])}];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return s})},bb9e:function(t,e,a){"use strict";a.r(e);var i=a("8110"),s=a("e69b");for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);a("7a1b");var o=a("2877"),r=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,"67de729c",null);e["default"]=r.exports},e69b:function(t,e,a){"use strict";a.r(e);var i=a("6afd"),s=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e["default"]=s.a}},[["1ba9","common/runtime","common/vendor"]]]);