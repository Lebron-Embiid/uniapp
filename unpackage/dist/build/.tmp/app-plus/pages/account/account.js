(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/account/account"],{1202:function(e,t,a){},"160a":function(e,t,a){"use strict";a.r(t);var n=a("7201"),o=a("8be6");for(var i in o)"default"!==i&&function(e){a.d(t,e,function(){return o[e]})}(i);a("e312");var c=a("2877"),s=Object(c["a"])(o["default"],n["a"],n["b"],!1,null,"9e3fee5e",null);t["default"]=s.exports},7201:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},o=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return o})},"744b":function(e,t,a){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{address:{id:"",name:"",mobile:"",province:"",city:"",district:"",detail:"",is_default:"",len:0},content:"",cat_list:[],array:["微信支付","支付宝支付"],index:0,express_price:0,accountList:[{},{}],all:118,level_price:0,total_price:0,mch_list:[],payment:0,pay_type:"WECHAT_PAY"}},onBackPress:function(){e.reLaunch({url:"/pages/store/store"})},methods:{toAddress:function(){console.log(a(JSON.stringify(this.mch_list)," at pages\\account\\account.vue:118")),e.navigateTo({url:"/pages/address_list/address_list?mch_list="+JSON.stringify(this.mch_list)})},bindPickerChange:function(e){console.log(a("picker发送选择改变，携带值为",e.target.value," at pages\\account\\account.vue:129")),this.index=e.target.value,0==this.index?(this.payment=0,this.pay_type="WECHAT_PAY"):1==this.index&&(this.payment=1,this.pay_type="ALIPAY"),console.log(a(this.index," at pages\\account\\account.vue:142"))},getMess:function(e){this.content=e.detail.value},toSubmit:function(t){var n=this;e.showLoading({title:"加载中",mask:!0}),console.log(a(n.mch_list," at pages\\account\\account.vue:153"));for(var o=0;o<n.mch_list.length;o++)n.mch_list[o].show=!1,n.mch_list[o].show_length=0,n.mch_list[o].offline=0,n.mch_list[o].content=n.content;if(console.log(a(n.mch_list," at pages\\account\\account.vue:170")),n.all>1e4)return e.showToast({title:"联系平台下单",icon:"none"}),!1;e.request({url:n.$api+"order/new-submit&access_token="+n.$access_token,method:"POST",data:{payment:n.payment,use_integral:1,formId:void 0,mch_list:JSON.stringify(n.mch_list)},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){if(console.log(a(t.data.code," at pages\\account\\account.vue:205")),1==t.data.code)return e.showToast({title:t.data.msg,icon:"none",duration:1500}),!1;e.showToast({title:"提交成功",icon:"none",duration:1500});var o=t.data.data.order_id;if(n.all<1e4)if(2==n.payment)e.request({url:n.$api+"order/pay-data&access_token="+n.$access_token,method:"GET",data:{order_id:t.data.data.order_id,pay_type:n.pay_type,parent_user_id:0,condition:2,cat_list:n.cat_list},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){t.data;e.showToast({title:t.data.msg,icon:"none",duration:1500}),0==t.data.code?e.navigateTo({url:"/pages/my_order/my_order?id=1"}):e.navigateTo({url:"/pages/my_order/my_order?id=0"})}});else{if(0==n.payment)var i="wxpay",c="http://app.youlan-china.com/wxpayv3/index.php";else i="alipay",c="http://app.youlan-china.com/alipayrsa2/index.php";e.request({url:c,method:"GET",dataType:"json",data:{price:t.data.data.total_price,goods_name:n.accountList[0].goods_name,order_no:t.data.data.order_no},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.hideLoading();var c=t.data;if(0==n.payment)var s=JSON.stringify({appid:c.appid,noncestr:c.noncestr,package:"Sign=WXPay",partnerid:c.partnerid,prepayid:c.prepayid,timestamp:c.timestamp,sign:c.sign});else s=c;e.getProvider({service:"payment",success:function(t){e.requestPayment({provider:i,orderInfo:s,success:function(t){e.request({url:n.$api+"order/wx-pay&order_id="+o+"&access_token="+n.$access_token,method:"GET",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.showToast({title:"支付成功！"}),e.navigateTo({url:"/pages/my_order/my_order?id=1"})},fail:function(t){e.navigateTo({url:"/pages/my_order/my_order?id=0"})}})},fail:function(t){console.log(a(JSON.stringify(t)," at pages\\account\\account.vue:321")),e.showToast({title:"支付失败",icon:"none"}),setTimeout(function(){e.navigateTo({url:"/pages/my_order/my_order?id=0"})},1500)}})},fail:function(t){e.showToast({title:"支付失败",icon:"none"}),setTimeout(function(){e.navigateTo({url:"/pages/my_order/my_order?id=0"})},1500)}})},fail:function(){e.hideLoading(),e.showToast({title:"支付失败！",icon:"none"})}})}else e.showToast({title:"金额大于一万请需通过其他渠道支付货款",icon:"none"}),setTimeout(function(){e.navigateTo({url:"/pages/my_order/my_order?id=0"})},1500)},fail:function(){e.showToast({title:"提交失败",icon:"none",duration:1500})}})}},onLoad:function(t){var n=this;n.$access_token=e.getStorageSync("access_token"),n.$level=e.getStorageSync("level");var o=JSON.parse(t.data);n.len=o.mch_list.length-1,console.log(a(n.len," at pages\\account\\account.vue:386")),n.cat_list=t.cat_list,n.address=o.address,n.accountList=o.mch_list[n.len].goods_list,console.log(a(n.accountList," at pages\\account\\account.vue:390")),n.mch_list=o.mch_list,n.express_price=o.mch_list[n.len].express_price,n.level_price=o.mch_list[n.len].level_price,n.total_price=o.mch_list[n.len].total_price,n.all=parseFloat(n.level_price)+parseFloat(n.express_price)}};t.default=n}).call(this,a("6e42")["default"],a("0de9")["default"])},"8be6":function(e,t,a){"use strict";a.r(t);var n=a("744b"),o=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t["default"]=o.a},e312:function(e,t,a){"use strict";var n=a("1202"),o=a.n(n);o.a}},[["c8cd","common/runtime","common/vendor"]]]);