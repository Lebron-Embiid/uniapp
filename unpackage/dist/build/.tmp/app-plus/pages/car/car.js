(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/car/car"],{5109:function(t,i,a){"use strict";var s=a("adbf"),e=a.n(s);e.a},8520:function(t,i,a){"use strict";var s=function(){var t=this,i=t.$createElement;t._self._c},e=[];a.d(i,"a",function(){return s}),a.d(i,"b",function(){return e})},"9d5b":function(t,i,a){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a={data:function(){return{isselectedall:!0,scrollposition:0,cart:[],mch_list:[{mch_id:"",goods_list:[]}],ordercart:[],buymore:[],list:[],goods_list:[],index:[],itemrecommend:[],totalamount:0,cntitems:0,shownullcart:!1}},onLoad:function(){var i=this;i.$access_token=t.getStorageSync("access_token"),i.$level=t.getStorageSync("level"),setTimeout(function(){t.request({url:i.$api+"cart/list&access_token="+i.$access_token,method:"GET",success:function(t){var a=[],s=t.data.data.list;for(var e in i.list=t.data.data.list,i.list)i.list[e].checked=!0;for(var c in console.log(i.list," at pages\\car\\car.vue:129"),s)a.push({id:s[c].cart_id,goods_id:s[c].goods_id,name:s[c].goods_name,imgsrc:s[c].goods_pic,quantity:s[c].num,price:s[c].unitPrice,attr_list:s[c].attr_list});i.cart=a;for(var n=0;n<i.cart.length;n++)i.totalamount=i.totalamount+i.cart[n].price*i.cart[n].quantity,i.cntitems=i.cntitems+i.cart[n].quantity,i.index.push(n),i.goods_list.push({cart_id:i.cart[n].id});i.totalamount=i.fmamount(i.totalamount),console.log(i.goods_list," at pages\\car\\car.vue:156"),0==i.cart.length?i.shownullcart=!0:i.shownullcart=!1},fail:function(){}})},1e3),t.startPullDownRefresh(this.cart)},onPullDownRefresh:function(){var i=this;setTimeout(function(){t.request({url:i.$api+"cart/list&access_token="+i.$access_token,method:"GET",success:function(t){var a=[],s=t.data.data.list;for(var e in i.list=t.data.data.list,i.list)i.list[e].checked=!0;for(var c in console.log(i.list," at pages\\car\\car.vue:201"),s)a.push({id:s[c].cart_id,goods_id:s[c].goods_id,name:s[c].goods_name,imgsrc:s[c].goods_pic,quantity:s[c].num,price:s[c].unitPrice,attr_list:s[c].attr_list});i.cart=a},fail:function(){}}),t.stopPullDownRefresh()},1e3)},computed:{},beforeDestroy:function(){try{t.setStorageSync("cart",this.cart)}catch(i){}},methods:{toStore:function(){t.reLaunch({url:"/pages/store/store"})},scrollhoming:function(){this.scrollposition=this.scrollposition-1},scrollhomed:function(){this.scrollposition=0},clickitemselectedall:function(){if(this.isselectedall=!this.isselectedall,this.isselectedall){if(this.cart)for(var t=0;t<this.cart.length;t++)this.cart[t].id<0&&(this.cart[t].id=-this.cart[t].id,this.cntitems=this.cntitems+this.cart[t].quantity,this.totalamount=this.totalamount+this.cart[t].price*this.cart[t].quantity,this.totalamount=this.fmamount(this.totalamount))}else if(this.cart)for(t=0;t<this.cart.length;t++)this.isselected(this.cart[t].id)&&(this.cart[t].id=-this.cart[t].id,this.cntitems=this.cntitems-this.cart[t].quantity,this.totalamount=this.totalamount-this.cart[t].price*this.cart[t].quantity,this.totalamount=this.fmamount(this.totalamount))},clickitemselected:function(t,i){if(this.cart)for(var a=0;a<this.cart.length;a++)if(this.cart[a].id==t)return this.cart[a].id=-this.cart[a].id,this.isselected(this.cart[a].id)?(this.cntitems=this.cntitems+this.cart[a].quantity,this.totalamount=this.totalamount+this.cart[a].price*this.cart[a].quantity,this.totalamount=this.fmamount(this.totalamount),this._isselectedall()&&(this.isselectedall=!0)):(this.cntitems=this.cntitems-this.cart[a].quantity,this.totalamount=this.totalamount-this.cart[a].price*this.cart[a].quantity,this.totalamount=this.fmamount(this.totalamount),this.isselectedall=!1),!1},clickdel:function(i){var a=this,s=[];s.push(i),console.log(s," at pages\\car\\car.vue:342"),t.showModal({title:"提示",content:"确定删除该商品？",success:function(e){e.confirm&&t.request({url:a.$api+"cart/delete&access_token="+a.$access_token,data:{cart_id_list:JSON.stringify(s)},method:"GET",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(s){t.showToast({title:s.data.msg,icon:"none"});for(var e=0;e<a.cart.length;e++)if(a.cart[e].id==i)return a.isselected(a.cart[e].id)?(a.cntitems=a.cntitems-a.cart[e].quantity,a.totalamount=a.totalamount-a.cart[e].price*a.cart[e].quantity,a.totalamount=a.fmamount(a.totalamount),a.cart[e].id=-99-i):a.cart[e].id=-99+i,a._isdeledall()&&(a.shownullcart=!0,a.isselectedall=!1),!1},fail:function(){t.showToast({title:e.data.msg,icon:"none"})}})}})},minusitem:function(t){for(var i=0;i<this.cart.length;i++)if(this.cart[i].id==t&&this.cart[i].quantity>0)return this.cart[i].quantity=this.cart[i].quantity-1,this.list[i].num=this.cart[i].quantity,console.log(this.list[i].num," at pages\\car\\car.vue:408"),this.isselected(this.cart[i].id)&&(this.updatecntitems(-1),this.updatetotalamt(-this.cart[i].price)),void(0==this.cart[i].quantity&&(this.cart[i].id=this._unselected(this.cart[i].id)))},plusitem:function(t){for(var i=0;i<this.cart.length;i++)if(this.cart[i].id==t&&this.cart[i].quantity<100)return this.cart[i].quantity=this.cart[i].quantity+1,this.list[i].num=this.cart[i].quantity,this.list[i].num=this.cart[i].quantity,console.log(this.list[i].num," at pages\\car\\car.vue:433"),this.isselected(this.cart[i].id)?(this.updatecntitems(1),this.updatetotalamt(this.cart[i].price)):(this.cart[i].id=this._selected(this.cart[i].id),this.cntitems=this.cntitems+this.cart[i].quantity,this.totalamount=this.totalamount+this.cart[i].price*this.cart[i].quantity,this.totalamount=this.fmamount(this.totalamount)),void(this._isselectedall()&&(this.isselectedall=!0))},clickitemhref:function(i){t.navigateTo({url:"/pages/store_detail/store_detail?id="+i})},updatetotalamt:function(t){this.totalamount=this.totalamount+t,this.totalamount=this.fmamount(this.totalamount)},updatecntitems:function(t){this.cntitems=this.cntitems+t},fmamount:function(t){return Math.round(100*t)/100},_unselected:function(t){return-Math.abs(t)},_selected:function(t){return Math.abs(t)},isselected:function(t){return t>0},_isselectedall:function(){for(var t=0;t<this.cart.length;t++)if(this.cart[t].id<0)return!1;return!0},_isdeledall:function(){for(var t=0;t<this.cart.length;t++)if(this.cart[t].id>-99)return!1;return!0},createorder:function(){var i=this;if(0==i.totalamount)t.showModal({content:"请选择下单的商品！"});else{for(var a=[],s=[],e=0;e<i.cart.length;e++)i.cart[e].id>0&&(a.push(i.cart[e].id),s.push(e));console.log(a," at pages\\car\\car.vue:544"),console.log(s.length," at pages\\car\\car.vue:545");for(var c=function(e){t.request({url:i.$api+"cart/cart-edit&access_token="+i.$access_token,method:"POST",data:{list:JSON.stringify([i.list[e]]),mch_list:JSON.stringify([])},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(c){if(0==c.data.code){var n=[];console.log(a.length," at pages\\car\\car.vue:561");for(var o=0;o<a.length;o++)n.push({cart_id:a[o]});i.mch_list[0].mch_id=0,i.mch_list[0].goods_list=n,e==s.length-1&&(console.log(e," at pages\\car\\car.vue:570"),t.request({url:i.$api+"order/new-submit-preview&access_token="+i.$access_token,method:"POST",data:{mch_list:JSON.stringify(i.mch_list)},dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(i){setTimeout(function(){t.navigateTo({url:"/pages/account/account?data="+JSON.stringify(i.data.data)})},1e3)}}))}else t.showToast({title:c.data.msg,icon:"none",duration:1500})}})},n=0;n<s.length;n++)c(n)}}}};i.default=a}).call(this,a("6e42")["default"])},"9eb7":function(t,i,a){"use strict";a.r(i);var s=a("9d5b"),e=a.n(s);for(var c in s)"default"!==c&&function(t){a.d(i,t,function(){return s[t]})}(c);i["default"]=e.a},adbf:function(t,i,a){},c2f6:function(t,i,a){"use strict";a.r(i);var s=a("8520"),e=a("9eb7");for(var c in e)"default"!==c&&function(t){a.d(i,t,function(){return e[t]})}(c);a("5109");var n=a("2877"),o=Object(n["a"])(e["default"],s["a"],s["b"],!1,null,null,null);i["default"]=o.exports}},[["461b","common/runtime","common/vendor"]]]);