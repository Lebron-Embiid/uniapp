(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/sunui-upimg/sunui-upimg"],{"10d1":function(e,t,n){"use strict";var i=n("ff27"),u=n.n(i);u.a},"659f":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},u=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u})},7276:function(e,t,n){"use strict";n.r(t);var i=n("659f"),u=n("de5c");for(var r in u)"default"!==r&&function(e){n.d(t,e,function(){return u[e]})}(r);n("10d1");var o=n("2877"),c=Object(o["a"])(u["default"],i["a"],i["b"],!1,null,"b8338144",null);t["default"]=c.exports},c4ac:function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=r(n("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,i,u,r,o){try{var c=e[r](o),a=c.value}catch(s){return void n(s)}c.done?t(a):Promise.resolve(a).then(i,u)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(i,u){var r=e.apply(t,n);function c(e){o(r,i,u,c,a,"next",e)}function a(e){o(r,i,u,c,a,"throw",e)}c(void 0)})}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n("8527"),l=n("4732");n("2ee6"),n("5b7c");var p=n("c90c"),f={data:function(){return{imgs:[],upLen:"",upload_picture_list:[]}},name:"sun-upimg",props:{upImgConfig:{type:Object,default:function(){return a({oos:!0,aliConfig:{AccessKeySecret:"zmOJcaqKJB5e4gqtLunHcNoMBTdDgp",OSSAccessKeyId:"LTAIPcJL9J5OZr2G",oosDirectory:"mifanimg"},url:"https://j.dns06.net.cn/index.php?m=Api&c=index&a=uploadDownwind",notli:!1,count:3,upreduce:!0,bgColor:"#eee",iconColor:"#ddd",iconReplace:"https://www.playsort.cn/right.png",text:"添加图片",delIconColor:"",delIconText:""},"iconReplace","")}}},methods:{chooseImage:function(e){_(this,parseInt(e),this.upImgConfig.url)},uploadimage:function(e){h(this,e)},deleteImg:function(e){v(e,this)},previewImg:function(e){y(e,this)},previewImgs:function(e){w(e,this)}}};t.default=f;var d=function(){var e=new Date;e.setHours(e.getHours()+s.timeout);var t=e.toISOString(),n={expiration:t,conditions:[["content-length-range",0,5242880]]},i=l.encode(JSON.stringify(n));return i},g=function(e,t){var n=e.upImgConfig.aliConfig.AccessKeySecret||s.AccessKeySecret,i=p.HMAC(p.SHA1,t,n,{asBytes:!0}),u=p.util.bytesToBase64(i);return u},m=function(){var t=c(u.default.mark(function t(n,r,o,a){var l,p,f,m,h,v,_;return u.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return l={aliyunFileKey:"".concat(r.upImgConfig.aliConfig.oosDirectory,"/")+(new Date).getTime()+Math.floor(150*Math.random())+".png",aliyunServerURL:n||s.uploadImageUrl,accessid:r.upImgConfig.aliConfig.OSSAccessKeyId||s.OSSAccessKeyId,url:r.upImgConfig.oos?n=r.upImgConfig.url||s.uploadImageUrl:n,oos:r.upImgConfig.oos},p=l.aliyunFileKey?l.aliyunFileKey:"",f=l.aliyunServerURL?l.aliyunServerURL:"",m=l.accessid?l.accessid:"",h=d(),v=g(r,h),t.next=8,e.uploadFile({url:l.url,filePath:o[a]["path"],name:"file",formData:{key:p,policy:h,OSSAccessKeyId:m,signature:v,success_action_status:"200"},success:function(){var t=c(u.default.mark(function t(n){var i,c;return u.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(200!=n.statusCode){t.next=8;break}return i=l.oos?"":JSON.parse(n.data),c=l.oos?f+p:i.info,o[a]["path_server"]=c,r.upload_picture_list=o,t.next=7,r.$emit("onUpImg",r.upload_picture_list);case 7:e.hideLoading();case 8:case"end":return t.stop()}},t,this)}));function n(e){return t.apply(this,arguments)}return n}(),fail:function(t){e.showLoading({title:"上传失败!"}),setTimeout(function(){e.hideLoading()},2e3),console.log(i(t," at components\\sunui-upimg\\sunui-upimg.vue:187"))}});case 8:_=t.sent,_.onProgressUpdate(function(){var e=c(u.default.mark(function e(t){var n,i;return u.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=0,i=r.upload_picture_list.length;case 1:if(!(n<i)){e.next=8;break}return e.next=4,t.progress;case 4:o[n]["upload_percent"]=e.sent;case 5:n++,e.next=1;break;case 8:r.upload_picture_list=o;case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return t.stop()}},t,this)}));return function(e,n,i,u){return t.apply(this,arguments)}}(),h=function(){var e=c(u.default.mark(function e(t,n){var i,r;return u.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i=0,r=t.upload_picture_list.length;case 1:if(!(i<r)){e.next=8;break}if(0!=t.upload_picture_list[i]["upload_percent"]){e.next=5;break}return e.next=5,m(n,t,t.upload_picture_list,i);case 5:i++,e.next=1;break;case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),v=function(e,t){t.upload_picture_list.splice(e.currentTarget.dataset.index,1),t.imgs.splice(e.currentTarget.dataset.index,1),t.upload_picture_list=t.upload_picture_list},_=function(t,n,u){var r={count:n,url:u,notli:t.upImgConfig.notli,sourceType:t.upImgConfig.sourceType,sizeType:t.upImgConfig.sizeType};e.chooseImage({count:r.notli?r.count=9:r.count,sizeType:r.sizeType?["compressed"]:["original"],sourceType:r.sourceType?["album","camera"]:["camera"],success:function(e){for(var n=0,o=e.tempFiles.length;n<o;n++)e.tempFiles[n]["upload_percent"]=0,e.tempFiles[n]["path_server"]="",t.upload_picture_list.push(e.tempFiles[n]),t.upload_picture_list.length>r.count&&(t.upload_picture_list=t.upload_picture_list.slice(0,r.count));!r.notli&&r.count==t.upload_picture_list.length&&h(t,u),r.notli&&9==r.count&&h(t,u),r.notli?console.log(i("%c up-img提醒您，开启了最大上传图片模式(单次选择最多9张,选择完即上传)","color:#f00;font-weight:bold;"," at components\\sunui-upimg\\sunui-upimg.vue:259")):console.log(i("%c up-img提醒您，开启了限制上传图片模式，目标数量为：".concat(r.count),"color:#f00;font-weight:bold;"," at components\\sunui-upimg\\sunui-upimg.vue:261")),t.imgs=t.imgs.concat(e.tempFilePaths),t.upload_picture_list=t.upload_picture_list.slice(0,r.count)}})},y=function(t,n){e.previewImage({current:n.imgs[t.currentTarget.dataset.index],urls:n.imgs})},w=function(t,n){e.previewImage({current:n.imgs[t.currentTarget.dataset.idx],urls:n.imgs})}}).call(this,n("6e42")["default"],n("0de9")["default"])},de5c:function(e,t,n){"use strict";n.r(t);var i=n("c4ac"),u=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,function(){return i[e]})}(r);t["default"]=u.a},ff27:function(e,t,n){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/sunui-upimg/sunui-upimg-create-component',
    {
        'components/sunui-upimg/sunui-upimg-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("7276"))
        })
    },
    [['components/sunui-upimg/sunui-upimg-create-component']]
]);                
